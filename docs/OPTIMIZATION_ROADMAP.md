# æ¶æ„ä¼˜åŒ–è·¯çº¿å›¾

åŸºäº LangGraph å®˜æ–¹æ–‡æ¡£çš„ç³»ç»Ÿæ€§ä¼˜åŒ–è®¡åˆ’

---

## ğŸ“Š å½“å‰çŠ¶æ€ vs ä¼˜åŒ–å

```
å½“å‰æ¶æ„ (è¯„åˆ†: 9/10)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Graph API                        â”‚ å®Œç¾
â”‚ âœ… Persistence (MemorySaver)        â”‚ å®Œç¾
â”‚ âœ… Agent-Specific Messages          â”‚ åˆ›æ–°ï¼ˆè¶…è¶Šå®˜æ–¹ç¤ºä¾‹ï¼‰
â”‚ âœ… Supervisor Pattern               â”‚ ç¬¦åˆæœ€ä½³å®è·µ
â”‚ âœ… Memory Management (50k trim)     â”‚ æ™ºèƒ½é«˜æ•ˆ
â”‚ âœ… Context Management               â”‚ æ­£ç¡®ä½¿ç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸  Streaming                       â”‚ ç¼ºå¤±
â”‚ âš ï¸  Durable Execution               â”‚ éƒ¨åˆ†å®ç°
â”‚ âš ï¸  Time Travel                     â”‚ ç¼ºå¤±
â”‚ ğŸ“ Subgraphs                        â”‚ æœªä½¿ç”¨
â”‚ ğŸ“ Human-in-the-loop                â”‚ æœªå®ç°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŒ–åæ¶æ„ (ç›®æ ‡: 10/10)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Graph API                        â”‚ ä¿æŒ
â”‚ âœ… Persistence                      â”‚ ä¿æŒ
â”‚ âœ… Agent-Specific Messages          â”‚ ä¿æŒ
â”‚ âœ… Supervisor Pattern               â”‚ ä¿æŒ
â”‚ âœ… Memory Management                â”‚ ä¿æŒ
â”‚ âœ… Context Management               â”‚ ä¿æŒ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ Streaming                        â”‚ æ–°å¢ - å®æ—¶ç›‘æ§
â”‚ âœ¨ Durable Execution                â”‚ å¢å¼º - å´©æºƒæ¢å¤
â”‚ âœ¨ Time Travel                      â”‚ æ–°å¢ - è°ƒè¯•å·¥å…·
â”‚ âœ¨ Subgraphs                        â”‚ æ–°å¢ - æ¨¡å—åŒ–
â”‚ â­ Human-in-the-loop                â”‚ å¯é€‰ - äººå·¥å®¡æŸ¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ä¼˜åŒ–ä¼˜å…ˆçº§çŸ©é˜µ

```
å½±å“åŠ›
  ^
  â”‚
é«˜â”‚  1ï¸âƒ£ Streaming          2ï¸âƒ£ Durable Execution
  â”‚  (å®æ—¶ç›‘æ§)             (å´©æºƒæ¢å¤)
  â”‚
  â”‚  3ï¸âƒ£ Time Travel        4ï¸âƒ£ Subgraphs
  â”‚  (è°ƒè¯•å·¥å…·)             (æ¨¡å—åŒ–)
ä¸­â”‚
  â”‚
  â”‚                        5ï¸âƒ£ Human-in-the-loop
ä½â”‚                        (äººå·¥å®¡æŸ¥)
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     ä½        ä¸­        é«˜       å¾ˆé«˜     å®ç°éš¾åº¦
```

---

## ğŸ“… å®æ–½è®¡åˆ’

### Phase 1: å¿«é€Ÿèµ¢å®¶ (1-2å‘¨) ğŸš€

#### Week 1: Streaming æ”¯æŒ
**ç›®æ ‡**: å®ç°å®æ—¶è¿›åº¦ç›‘æ§

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ `workflow.py::run()` æ·»åŠ  `stream` å‚æ•°
- [ ] å®ç°æµå¼è¾“å‡ºé€»è¾‘
- [ ] æ·»åŠ èŠ‚ç‚¹çº§æ—¥å¿—è®°å½•
- [ ] å®ç°åŠ¨æ€ä¸­æ–­æ£€æµ‹
- [ ] æ›´æ–° `main.py` æ·»åŠ  `--stream` é€‰é¡¹
- [ ] ç¼–å†™æµ‹è¯•ç”¨ä¾‹

**ä»£ç ä¿®æ”¹**:
```python
# workflow.py
def run(self, ..., stream=False):
    if stream:
        for update in compiled_workflow.stream(...):
            logger.info(f"ğŸ“Š {list(update.keys())[0]} completed")
            final_state = update
```

**æµ‹è¯•å‘½ä»¤**:
```bash
python agent_graph/main.py -y benchmark.yaml --stream
```

**é¢„æœŸæ•ˆæœ**:
- âœ… å®æ—¶çœ‹åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œ
- âœ… åŠæ—©å‘ç°é—®é¢˜
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

---

#### Week 2: Durable Execution
**ç›®æ ‡**: å®ç°å´©æºƒæ¢å¤èƒ½åŠ›

**ä»»åŠ¡æ¸…å•**:
- [ ] æ·»åŠ  `resume` å‚æ•°åˆ° `run()`
- [ ] å®ç°æ£€æŸ¥ç‚¹å†å²æŸ¥è¯¢
- [ ] æ·»åŠ çŠ¶æ€æ¢å¤é€»è¾‘
- [ ] åœ¨å…³é”®èŠ‚ç‚¹æ·»åŠ å…ƒæ•°æ®
- [ ] å®ç°è‡ªåŠ¨æ¢å¤æœºåˆ¶
- [ ] ç¼–å†™æ¢å¤æµ‹è¯•

**ä»£ç ä¿®æ”¹**:
```python
# workflow.py
def run(self, ..., resume=False):
    if resume:
        state_history = list(compiled_workflow.get_state_history(config))
        if state_history:
            logger.info("ğŸ”„ Resuming from last checkpoint")
```

**æµ‹è¯•åœºæ™¯**:
```bash
# è¿è¡Œåˆ°ä¸€åŠæ‰‹åŠ¨ä¸­æ–­
python agent_graph/main.py -y benchmark.yaml
^C  # Ctrl+C ä¸­æ–­

# æ¢å¤æ‰§è¡Œ
python agent_graph/main.py -y benchmark.yaml --resume
```

**é¢„æœŸæ•ˆæœ**:
- âœ… å´©æºƒåå¯ä»¥æ¢å¤
- âœ… èŠ‚çœ LLM è°ƒç”¨æˆæœ¬
- âœ… é€‚åˆé•¿æ—¶é—´è¿è¡Œ

---

### Phase 2: åŠŸèƒ½å¢å¼º (2-4å‘¨) ğŸ”§

#### Week 3-4: Time Travel å·¥å…·
**ç›®æ ‡**: å¼ºå¤§çš„è°ƒè¯•å’Œå®éªŒèƒ½åŠ›

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `tools/replay.py` æ¨¡å—
- [ ] å®ç° `replay_workflow()` å‡½æ•°
- [ ] æ·»åŠ æ£€æŸ¥ç‚¹æµè§ˆå™¨
- [ ] å®ç°çŠ¶æ€ä¿®æ”¹åŠŸèƒ½
- [ ] åˆ›å»ºå‘½ä»¤è¡Œå·¥å…·
- [ ] ç¼–å†™ç”¨æˆ·æŒ‡å—

**æ–°æ–‡ä»¶**:
```python
# tools/replay.py
def replay_workflow(workflow, benchmark, trial, checkpoint_id=None, modifications=None):
    """å›æ”¾å·¥ä½œæµåˆ°ç‰¹å®šæ£€æŸ¥ç‚¹"""
    ...

def list_checkpoints(benchmark, trial):
    """åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æ£€æŸ¥ç‚¹"""
    ...

def inspect_checkpoint(checkpoint_id):
    """æŸ¥çœ‹æ£€æŸ¥ç‚¹è¯¦æƒ…"""
    ...
```

**ä½¿ç”¨ç¤ºä¾‹**:
```bash
# åˆ—å‡ºæ£€æŸ¥ç‚¹
python tools/replay.py list --benchmark cjson --trial 0

# å›æ”¾åˆ°ç‰¹å®šæ£€æŸ¥ç‚¹
python tools/replay.py run --benchmark cjson --trial 0 \
  --checkpoint after_prototyper \
  --modify max_retries=10
```

**é¢„æœŸæ•ˆæœ**:
- âœ… å¼ºå¤§çš„è°ƒè¯•èƒ½åŠ›
- âœ… A/B æµ‹è¯•ä¸åŒç­–ç•¥
- âœ… ä»æˆåŠŸçŠ¶æ€é‡æ–°åˆ†æ”¯

---

#### Week 5-6: Subgraphs é‡æ„
**ç›®æ ‡**: æ¨¡å—åŒ–æ¶æ„

**ä»»åŠ¡æ¸…å•**:
- [ ] è®¾è®¡å­å›¾ç»“æ„
- [ ] åˆ›å»º Build-Enhance å­å›¾
- [ ] é‡æ„ supervisor é€»è¾‘
- [ ] åˆ›å»ºæµ‹è¯•-æ‰§è¡Œå­å›¾ï¼ˆå¯é€‰ï¼‰
- [ ] æ›´æ–°æ‰€æœ‰æµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£

**æ–°æ–‡ä»¶**:
```python
# agent_graph/subgraphs/build_enhance.py
def create_build_enhance_subgraph():
    """Build-Enhance å¾ªç¯å­å›¾"""
    ...

# agent_graph/subgraphs/test_execute.py
def create_test_execute_subgraph():
    """Test-Execute å¾ªç¯å­å›¾"""
    ...
```

**æ¶æ„å˜åŒ–**:
```
ä¹‹å‰:
Supervisor â†’ Build â†’ Supervisor â†’ Enhance â†’ Supervisor â†’ Build â†’ ...

ä¹‹å:
Supervisor â†’ [Build-Enhance Subgraph] â†’ Supervisor
             â†“
             Build â†’ Check â†’ Enhance â†’ Build
                      â†“
                     Success â†’ Exit
```

**é¢„æœŸæ•ˆæœ**:
- âœ… æ›´æ¸…æ™°çš„é€»è¾‘
- âœ… å¯é‡ç”¨çš„ç»„ä»¶
- âœ… æ›´å®¹æ˜“æµ‹è¯•

---

### Phase 3: é«˜çº§åŠŸèƒ½ (é•¿æœŸ) â­

#### Week 7+: Human-in-the-loop
**ç›®æ ‡**: å…³é”®å†³ç­–ç‚¹çš„äººå·¥å¹²é¢„

**ä»»åŠ¡æ¸…å•**:
- [ ] è®¾è®¡äººå·¥å®¡æŸ¥ç•Œé¢
- [ ] å®ç° `human_review_node`
- [ ] æ·»åŠ æš‚åœ/æ¢å¤æœºåˆ¶
- [ ] åˆ›å»º Web UIï¼ˆå¯é€‰ï¼‰
- [ ] é›†æˆåˆ° workflow
- [ ] ç”¨æˆ·åŸ¹è®­

**å®ç°æ–¹å¼**:
```python
# ç®€å•ç‰ˆæœ¬ï¼šå‘½ä»¤è¡Œäº¤äº’
def human_review_node(state, config):
    """æš‚åœå¹¶ç­‰å¾…äººå·¥è¾“å…¥"""
    print("â¸ï¸  éœ€è¦äººå·¥å®¡æŸ¥")
    print(f"å½“å‰ä»£ç ï¼š\n{state['fuzz_target_source']}")
    
    # æš‚åœï¼Œç­‰å¾…å¤–éƒ¨æ›´æ–°
    ...

# é«˜çº§ç‰ˆæœ¬ï¼šWeb UI
# åˆ›å»º FastAPI æœåŠ¡ï¼Œæä¾›å®¡æŸ¥ç•Œé¢
```

**ä½¿ç”¨åœºæ™¯**:
- ç¼–è¯‘å¤±è´¥ 3 æ¬¡åè¯·æ±‚å®¡æŸ¥
- Crash åˆ†æä¸ç¡®å®šæ—¶
- ä»£ç è´¨é‡æ£€æŸ¥

**é¢„æœŸæ•ˆæœ**:
- âœ… äººç±»ä¸“å®¶å‚ä¸
- âœ… æé«˜ä»£ç è´¨é‡
- âœ… å‡å°‘æ— æ•ˆå°è¯•

---

## ğŸ“ˆ æˆæœ¬æ”¶ç›Šåˆ†æ

| ä¼˜åŒ–é¡¹ | å®ç°æˆæœ¬ | é¢„æœŸæ”¶ç›Š | ROI |
|--------|---------|---------|-----|
| **Streaming** | 1å‘¨ | å¤§å¹…æå‡ç”¨æˆ·ä½“éªŒ | â­â­â­â­â­ |
| **Durable Execution** | 1å‘¨ | èŠ‚çœ50%é‡è·‘æˆæœ¬ | â­â­â­â­â­ |
| **Time Travel** | 2å‘¨ | 10xè°ƒè¯•æ•ˆç‡ | â­â­â­â­ |
| **Subgraphs** | 2å‘¨ | é•¿æœŸç»´æŠ¤æ€§æå‡ | â­â­â­â­ |
| **Human-in-the-loop** | 3-4å‘¨ | è´¨é‡æå‡30%+ | â­â­â­ |

---

## âœ… éªŒæ”¶æ ‡å‡†

### Phase 1 å®Œæˆæ ‡å‡†
- [ ] `--stream` é€‰é¡¹æ­£å¸¸å·¥ä½œ
- [ ] å®æ—¶çœ‹åˆ°èŠ‚ç‚¹æ‰§è¡Œè¿›åº¦
- [ ] `--resume` é€‰é¡¹å¯ä»¥æ¢å¤ä¸­æ–­çš„è¿è¡Œ
- [ ] å´©æºƒåä¸ä¸¢å¤±è¿›åº¦
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

### Phase 2 å®Œæˆæ ‡å‡†
- [ ] `tools/replay.py` å·¥å…·å¯ç”¨
- [ ] å¯ä»¥åˆ—å‡ºå’ŒæŸ¥çœ‹æ£€æŸ¥ç‚¹
- [ ] å¯ä»¥ä¿®æ”¹çŠ¶æ€å¹¶é‡æ”¾
- [ ] Subgraphs é€»è¾‘æ¸…æ™°
- [ ] Build-Enhance å¾ªç¯å°è£…è‰¯å¥½
- [ ] æ–‡æ¡£æ›´æ–°å®Œæ•´

### Phase 3 å®Œæˆæ ‡å‡†
- [ ] Human review ç•Œé¢å¯ç”¨
- [ ] å¯ä»¥æš‚åœå’Œæ¢å¤ workflow
- [ ] äººå·¥ä¿®æ”¹å¯ä»¥æ­£ç¡®åº”ç”¨
- [ ] ç”¨æˆ·æŒ‡å—å®Œå–„

---

## ğŸ“ å­¦ä¹ èµ„æº

### å¿…è¯»æ–‡æ¡£
1. [LangGraph Streaming Guide](https://langchain-ai.github.io/langgraph/guides/)
2. [Persistence & Checkpointing](https://langchain-ai.github.io/langgraph/guides/)
3. [Durable Execution](https://langchain-ai.github.io/langgraph/guides/)

### å‚è€ƒç¤ºä¾‹
1. [LangGraph Examples - Multi-agent](https://github.com/langchain-ai/langgraph/tree/main/examples)
2. [LangGraph Tutorials](https://langchain-ai.github.io/langgraph/)

---

## ğŸ“ æ³¨æ„äº‹é¡¹

### âš ï¸ é£é™©ç®¡ç†
1. **å‘åå…¼å®¹**: æ‰€æœ‰æ–°åŠŸèƒ½éƒ½æ˜¯å¯é€‰çš„ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½
2. **æ¸è¿›å¼å®æ–½**: ä¸€æ¬¡åªå®æ–½ä¸€ä¸ªåŠŸèƒ½ï¼Œå……åˆ†æµ‹è¯•
3. **å›æ»šè®¡åˆ’**: æ¯ä¸ª Phase éƒ½åº”è¯¥å¯ä»¥ç‹¬ç«‹å›æ»š

### ğŸ’¡ æœ€ä½³å®è·µ
1. **å…ˆå†™æµ‹è¯•**: æ¯ä¸ªæ–°åŠŸèƒ½éƒ½åº”è¯¥æœ‰æµ‹è¯•
2. **æ–‡æ¡£åŒæ­¥**: ä»£ç å’Œæ–‡æ¡£åŒæ­¥æ›´æ–°
3. **ä»£ç å®¡æŸ¥**: é‡è¦ä¿®æ”¹éœ€è¦å®¡æŸ¥

---

## ğŸ¯ æœ€ç»ˆç›®æ ‡

å®Œæˆæ‰€æœ‰ Phase åï¼Œä½ ä»¬çš„æ¶æ„å°†å…·å¤‡ï¼š

âœ… **å®Œæ•´çš„ LangGraph åŠŸèƒ½æ”¯æŒ**
- Streaming âœ“
- Persistence âœ“
- Durable Execution âœ“
- Time Travel âœ“
- Subgraphs âœ“
- Human-in-the-loop âœ“

âœ… **ä¼ä¸šçº§çš„å¯é æ€§**
- å´©æºƒæ¢å¤èƒ½åŠ›
- å®Œå–„çš„é”™è¯¯å¤„ç†
- å…¨é¢çš„æ—¥å¿—è®°å½•

âœ… **å“è¶Šçš„å¼€å‘è€…ä½“éªŒ**
- å®æ—¶ç›‘æ§
- å¼ºå¤§çš„è°ƒè¯•å·¥å…·
- æ¸…æ™°çš„æ¶æ„

âœ… **ä¸šç•Œé¢†å…ˆçš„è®¾è®¡**
- Agent-specific messagesï¼ˆåˆ›æ–°ï¼‰
- Supervisor patternï¼ˆæœ€ä½³å®è·µï¼‰
- æ¨¡å—åŒ–æ¶æ„ï¼ˆå¯ç»´æŠ¤ï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-10-21  
**ç»´æŠ¤è€…**: Logic-Fuzz Team

